{% extends "base.html" %}
{% block imports %}
    {{ import('scripts/leaderboard.js') }}
{% endblock %}
{% block content %}
    <div class="d-flex justify-content-center justify-content-sm-start">
        <h1>Leaderboard</h1>
    </div>
    <div class="px-3 d-none d-sm-block">
        <p class="lead">
            The current standings
        </p>
    </div>

    {% macro leaderboard_entry(position, name, is_real_name, nickname, wins, losses, draws, score, is_header, is_you, is_bot) %}
        <div class="p-1 px-md-3 text-nowrap" id="leaderboard-entry-{{- position }}">
            <div class="px-lg-5 d-flex justify-content-center">
                <div class="max-width-center d-flex w-100 flex-row p-2 p-md-3 leaderboard-submission
            {% if is_header %} border-bottom fw-bold {% elif is_you %} leaderboard-user-submission
            {% elif is_bot %} leaderboard-bot-submission {% else %} leaderboard-other-submission {% endif %}">
                    <div class="leaderboard-position">
                        {{ position }}
                    </div>
                    <div class="leaderboard-name flex-column">
                        <div class="row">
                            <div class="p-0 col-auto">
                                {{ name }}
                            </div>
                            {% if is_real_name %}
                                <div class="col-6 d-none d-lg-block nickname-text">
                                    ({{ nickname }})
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="leaderboard-wins d-none d-md-block">
                        {{ wins }}
                    </div>
                    <div class="leaderboard-losses d-none d-md-block">
                        {{ losses }}
                    </div>
                    <div class="leaderboard-draws d-none d-md-block">
                        {{ draws }}
                    </div>
                    <div class="leaderboard-spacer d-none d-lg-block">
                    </div>
                    <div class="leaderboard-score">
                        {{ score }}
                    </div>
                </div>
            </div>
        </div>
    {% endmacro %}
    {% macro all_leaderboard(items) %}
        {{ leaderboard_entry("Position", "Name", False, "", "Wins", "Losses", "Draws", "Score", True, False, False) }}
        {% for item in items %}
            {{ leaderboard_entry(loop.index, item.user.display_name, item.user.display_real_name, item.user.nickname,
            human_format(item.outcomes.wins), human_format(item.outcomes.losses), human_format(item.outcomes.draws),
            item.score_text, False, item.is_you, item.user.is_bot) }}
        {% endfor %}
    {% endmacro %}
    <div class="d-none d-sm-flex justify-content-center py-3 px-lg-2 mx-lg-3 mx-xl-5" id="overTimeChartContainer">

    </div>
    <div class="d-flex justify-content-center">
        <div class="d-flex flex-column py-2 flex-grow-1" id="leaderboard">
            {{ all_leaderboard(leaderboard) }}
        </div>
    </div>

    <script>
        leaderboard.fade_in(() => leaderboard.make_graph());
    </script>
{% endblock %}
